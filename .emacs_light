;; Added by Package.el.  This must come before configurations of
;; installed packages.  Don't delete this line.  If you don't want it,
;; just comment it out by adding a semicolon to the start of the line.
;; You may delete these explanatory comments.

(require 'package)

(package-initialize)
(package-refresh-contents)

(defun install-if-not (package)
  (when (not (package-installed-p package))
    (package-install package)))

(install-if-not 'company)
(install-if-not 'yaml-mode)

(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(custom-enabled-themes '(wheatgrass)))

(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 )

;; UI
(fringe-mode 1)
(menu-bar-mode -1)
(tool-bar-mode -1)
(scroll-bar-mode -1)
(setq inhibit-startup-screen t)

(setq-default tab-width 4)
(setq-default c-basic-offset 4)
(setq-default indent-tabs-mode nil)

(setq auto-save-default nil)
(setq make-backup-files nil)
(setq ring-bell-function 'ignore)

;; Modes
(fido-mode)
(fido-vertical-mode)

(defun dev-modes ()
  (interactive)
  (electric-pair-mode)
  (hs-minor-mode)
  (company-mode))

(add-hook 'c++-mode-hook 'dev-modes)
(add-hook 'c-mode-hook 'dev-modes)
(add-hook 'emacs-lisp-mode-hook 'dev-modes)

;; Keybinds
(keymap-global-set "M-o" 'find-file)
(keymap-global-set "M-e" 'execute-extended-command)
(keymap-global-set "M-s" 'save-buffer)
(keymap-global-set "M-k" 'kill-current-buffer)
(keymap-global-set "M-i" 'imenu)
(keymap-global-set "M-\]" 'next-error)
(keymap-global-set "M-\[" 'previous-error)
(keymap-global-set "M-/" 'xref-find-references)

(keymap-global-set "C-;" 'comment-line)
(keymap-global-set "M-p" 'switch-to-buffer)

(keymap-global-set "M-1" 'delete-other-windows)
(keymap-global-set "M-2" 'split-window-vertically)
(keymap-global-set "M-3" 'split-window-horizontally)
(keymap-global-set "M-4" 'other-window)
(keymap-global-set "M-0" 'delete-window)

(defun marco-grep (pattern)
  (interactive "sPattern: ")
  (setq cmd (format "grep -rn . -ie \'%s\'" pattern))
  (lgrep cmd))

(keymap-global-set "M-t" 'marco-grep)

(defun remote-docker-container (user ip container path)
  "Connect to remote docker container"
  (setq cmd (format "/ssh:%s@%s|docker:%s:%s" user ip container path))
  (find-file cmd))

(defun sandbox ()
  "Run sandbox tfs."
  (interactive)
  (remote-docker-container "user" "ip" "container" "path"))

(defun tfs ()
  "Run tfs."
  (interactive)
  (remote-docker-container "user" "ip" "container" "path"))


(defun ms ()
  "Run ms."
  (interactive)
  (remote-docker-container "user" "ip" "container" "path"))
